<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maze Game with Walls</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        #maze-container {
            position: relative;
            width: 90vmin;
            height: 90vmin;
            border: 2px solid #000;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(10, 1fr);
            background-color: #fff;
            box-sizing: border-box;
            margin-top: 70px;
            padding: 20px;
        }

        .cell {
            box-sizing: border-box;
           
        }

        #ball {
            position: absolute;
            width: 9vmin;
            height: 9vmin;
            background-color: red;
            border-radius: 50%;
            box-sizing: border-box;
        }

        .wall {
            position: absolute;
            width: 4vmin;
            height: 9vmin;
            background-color: #000;
            box-sizing: border-box;
           
        }
         .space {
            position: absolute;
            width: 9vmin;
            height: 9vmin;
            box-sizing: border-box;
            
        }

        .goal {
            position: absolute;
            width: 9vmin;
            height: 9vmin;
            background-color: green;
            opacity: 0.5;
            box-sizing: border-box;
        }

        #no-gyro-message {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ffcc00;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <button onclick="onClick()">GIVE ME YOUR GYROSCOPE!!!</button>
        <div id="maze-container">
            <div id="ball"></div>
        </div>
    </div>
    <div id="no-gyro-message">Gyroscope not available. Use arrow keys to move.</div>
    <script>
        const ball = document.getElementById('ball');
        const mazeContainer = document.getElementById('maze-container');
        const noGyroMessage = document.getElementById('no-gyro-message');
        const mazeSize = 10;
        const cellSize = 9;

        function onClick() {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission()
                .then((state) => {
                    if (state === 'granted') {
                    window.addEventListener('devicemotion', handleOrientation);
                    } else {
                    console.error('Request to access the orientation was rejected');
                    }
                })
                .catch(console.error);
            } else {
                window.addEventListener('devicemotion', handleOrientation);
            }
        }

        let ballPosition = { x: 0, y: 0 };
        let velocity = { x: 0, y: 0 };
        let friction = 0.98;
        let sensitivity = 0.009;

        /*const maze = [
            [0, 1, 0, 0, 0, 0, 1, 0, 0, 0],
            [0, 1, 0, 1, 1, 0, 1, 0, 1, 0],
            [0, 1, 0, 1, 0, 0, 1, 0, 1, 0],
            [0, 0, 0, 1, 0, 1, 0, 0, 1, 0],
            [1, 1, 0, 1, 0, 1, 0, 1, 1, 0],
            [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            [0, 1, 1, 1, 1, 1, 0, 1, 0, 1],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ];*/
        const maze = [
            [
                { top: true, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: true, bottom: false, left: false },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: true, bottom: false, left: false }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: false },
                { top: false, right: false, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: false, bottom: true, left: true },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: false },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: false, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: false },
                { top: true, right: false, bottom: true, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: false, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: false },
                { top: true, right: false, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: true, bottom: true, left: true },
                { top: true, right: true, bottom: true, left: true },
                { top: true, right: true, bottom: true, left: true },
                { top: true, right: true, bottom: false, left: true },
                { top: true, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: true, left: true },
                { top: true, right: true, bottom: false, left: false },
                { top: true, right: true, bottom: true, left: true },
                { top: true, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: true, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: true },
                { top: false, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: true, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: true },
                { top: false, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: true, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: true },
                { top: false, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true }
            ],
            [
                { top: false, right: true, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: true },
                { top: true, right: false, bottom: false, left: false },
                { top: true, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: false, left: true },
                { top: false, right: true, bottom: true, left: true },
                { top: false, right: true, bottom: false, left: false },
                { top: false, right: true, bottom: false, left: true }
            ]
        ];

        let goalPosition = setNewGoal();

        function setNewGoal() {
            let newPos = {
                x: Math.floor(Math.random() * mazeSize),
                y: Math.floor(Math.random() * mazeSize)
            };

            while ((newPos.x === 0 && newPos.y === 0) || maze[newPos.y][newPos.x] === 1) {
                newPos.x = Math.floor(Math.random() * mazeSize);
                newPos.y = Math.floor(Math.random() * mazeSize);
            }

            return newPos;
        }

        const goal = document.createElement('div');
        goal.className = 'goal';
        goal.style.left = `${goalPosition.x * cellSize}vmin`;
        goal.style.top = `${goalPosition.y * cellSize}vmin`;
        mazeContainer.appendChild(goal);

        // Create maze walls and spaces
        maze.forEach((row, y) => {
            row.forEach((cell, x) => {
                if (cell.top) createWall(x, y, 'top');
                if (cell.right) createWall(x, y, 'right');
                if (cell.bottom) createWall(x, y, 'bottom');
                if (cell.left) createWall(x, y, 'left');
                createSpace(x, y, 'space');
            });
        });

        function createWall(x, y, position) {
            const wall = document.createElement('div');
            wall.classList.add('wall', position);
            wall.style.top = `${y * cellSize + 1}vmin`;
            wall.style.left = `${x * cellSize + 1}vmin`;
            if (position === 'top' || position === 'bottom') {
                wall.style.width = `${cellSize}vmin`;
                wall.style.height = '1vmin';
            } else {
                wall.style.width = '1vmin';
                wall.style.height = `${cellSize}vmin`;
            }
            mazeContainer.appendChild(wall);
        }

        function createSpace(x, y) {
            const space = document.createElement('div');
            space.classList.add('space');
            space.style.top = `${y * cellSize + 1}vmin`;
            space.style.left = `${x * cellSize + 1}vmin`;
            mazeContainer.appendChild(space);
        }

        function checkCollision(position, direction) {
            const { x, y } = position;
            const cell = maze[y] && maze[y][x];

            if (!cell) return false;

            switch (direction) {
                case 'left':
                    return !cell.left;
                case 'right':
                    return !cell.right;
                case 'up':
                    return !cell.top;
                case 'down':
                    return !cell.bottom;
                default:
                    return false;
            }
        }

        function moveBall() {
            velocity.x *= friction;
            velocity.y *= friction;

            const nextPosition = {
                x: ballPosition.x + velocity.x,
                y: ballPosition.y + velocity.y
            };

            const roundedPosition = {
                x: Math.round(nextPosition.x),
                y: Math.round(nextPosition.y)
            };

            if (checkCollision(roundedPosition, 'left') && velocity.x < 0) {
                velocity.x = 0;
            }

            if (checkCollision(roundedPosition, 'right') && velocity.x > 0) {
                velocity.x = 0;
            }

            if (checkCollision(roundedPosition, 'up') && velocity.y < 0) {
                velocity.y = 0;
            }

            if (checkCollision(roundedPosition, 'down') && velocity.y > 0) {
                velocity.y = 0;
            }

            ballPosition.x += velocity.x;
            ballPosition.y += velocity.y;

            if (ballPosition.x < 0) ballPosition.x = 0;
            if (ballPosition.x > mazeSize - 1) ballPosition.x = mazeSize - 1;
            if (ballPosition.y < 0) ballPosition.y = 0;
            if (ballPosition.y > mazeSize - 1) ballPosition.y = mazeSize - 1;

            ball.style.left = `${ballPosition.x * cellSize + 1}vmin`;
            ball.style.top = `${ballPosition.y * cellSize + 1}vmin`;

            requestAnimationFrame(moveBall);
        }

        function handleOrientation(event) {
            const accelerationX = event.accelerationIncludingGravity.x;
            const accelerationY = event.accelerationIncludingGravity.y;

            velocity.x += accelerationX * sensitivity;
            velocity.y += accelerationY * sensitivity;
        }

        moveBall();

        // Fallback for devices without gyroscope
        if (!('ondevicemotion' in window)) {
            noGyroMessage.style.display = 'block';
            window.addEventListener('keydown', (event) => {
                switch (event.key) {
                    case 'ArrowLeft':
                        velocity.x = -1;
                        break;
                    case 'ArrowRight':
                        velocity.x = 1;
                        break;
                    case 'ArrowUp':
                        velocity.y = -1;
                        break;
                    case 'ArrowDown':
                        velocity.y = 1;
                        break;
                }
            });
        }
    </script>
</body>
</html>
